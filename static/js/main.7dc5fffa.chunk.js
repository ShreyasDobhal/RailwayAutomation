(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{20:function(e,l,a){},21:function(e,l,a){},26:function(e){e.exports=JSON.parse('[{"label":"ADHYATMIK NAGAR","value":"AKNR"},{"label":"AGHWANPUR","value":"AWP"},{"label":"AIGAWAN","value":"AIG"},{"label":"AITHAL","value":"ATMO"},{"label":"ALAMNAGAR","value":"AMG"},{"label":"AMHERA","value":"ARH"},{"label":"AMROHA","value":"AMRO"},{"label":"ANJHI SHAHABAD","value":"AJI"},{"label":"AONLA","value":"AO"},{"label":"ARSENI","value":"ASI"},{"label":"ASAFPUR","value":"AFR"},{"label":"ATRAULI ROAD","value":"AUR"},{"label":"ATWA KURSATH","value":"ATKS"},{"label":"ATWA MUTHIA","value":"ATW"},{"label":"BABRALA","value":"BBA"},{"label":"BABUGARH","value":"BBO"},{"label":"BAGARPUR","value":"BGRR"},{"label":"BAGHAULI","value":"BGH"},{"label":"BAHADURPUR","value":"BHDH"},{"label":"BAHJOI","value":"BJ"},{"label":"BAKAINA","value":"BKNA"},{"label":"BALAMAU","value":"BLM"},{"label":"BALAWALI","value":"BLW"},{"label":"BALIAKHERI","value":"BAE"},{"label":"BANGARMAU","value":"BGMU"},{"label":"BANTHRA","value":"BTRA"},{"label":"BARADEV","value":"BRDV"},{"label":"BARAL","value":"BARL"},{"label":"BAREILLY CANTT.","value":"BRYC"},{"label":"BAREILLY","value":"BE"},{"label":"BARMI","value":"BRMX"},{"label":"BARTARA","value":"BRTA"},{"label":"BASHARATGANJ","value":"BTG"},{"label":"BASI KIRATPUR","value":"BSKR"},{"label":"BEHTAGOKUL","value":"BEG"},{"label":"BENIGANJ","value":"BEJ"},{"label":"BHAKRAULI","value":"BHKL"},{"label":"BHITAURA","value":"BTO"},{"label":"BIJNOR","value":"BJO"},{"label":"BILPUR","value":"BLPU"},{"label":"BULANDSHAHR","value":"BSC"},{"label":"BUNDKI","value":"BEK"},{"label":"CHAK KALI LAIT","value":"CKLT"},{"label":"CHAKRAJ MAL","value":"CAJ"},{"label":"CHANDAUSI","value":"CH"},{"label":"CHANDOK","value":"CNK"},{"label":"CHANDPUR SIAU","value":"CPS"},{"label":"CHANDSARA","value":"CXA"},{"label":"CHHAPRAWAT","value":"CHWT"},{"label":"CHODIALA","value":"CDL"},{"label":"CHUCHELA KALAN","value":"CLKN"},{"label":"CLUTTERBUCKGANJ","value":"CBJ"},{"label":"DABTARA","value":"DUB"},{"label":"DALELNAGAR","value":"DLQ"},{"label":"DALPATPUR","value":"DLP"},{"label":"DASNA","value":"DS"},{"label":"DAUSNI","value":"DSNI"},{"label":"DEHRADUN","value":"DDN"},{"label":"DHAMORA","value":"DAM"},{"label":"DHAMPUR","value":"DPR"},{"label":"DHANARI","value":"DN"},{"label":"DHANDERA","value":"DNRA"},{"label":"DHANETA","value":"DAN"},{"label":"DHARAMPUR","value":"DMPR"},{"label":"DIBAI","value":"DIB"},{"label":"DILAWARNAGAR","value":"DIL"},{"label":"DOIWALA","value":"DWO"},{"label":"DUGANPUR","value":"DUN"},{"label":"FARHATNAGAR","value":"FRH"},{"label":"FARHEDI","value":"FRD"},{"label":"FATEHPUR CHAURASI","value":"FTC"},{"label":"FAZALPUR","value":"FZL"},{"label":"GAJRAULA","value":"GJL"},{"label":"GAJU","value":"GAJU"},{"label":"GANJ MURADABAD","value":"GJMB"},{"label":"GARHMUKTESAR","value":"GMS"},{"label":"GARHMUKTESAR BRIDGE","value":"GGB"},{"label":"GAUNTRA","value":"GNTR"},{"label":"GHAUSGANJ","value":"GSGJ"},{"label":"GHORI","value":"GHRI"},{"label":"GODHA","value":"GDHA"},{"label":"GULAOTHI","value":"GLH"},{"label":"GUMTHAL","value":"GTF"},{"label":"HABIBWALA","value":"HBW"},{"label":"HAFIZPUR","value":"HZR"},{"label":"HAKIMPUR","value":"HKP"},{"label":"HALDAUR","value":"HLDR"},{"label":"HAPUR","value":"HPU"},{"label":"HARDOI","value":"HRI"},{"label":"HARIDWAR","value":"HW"},{"label":"HARRAWALA","value":"HRW"},{"label":"HARTHALA","value":"HRH"},{"label":"HAZRAT NAGAR","value":"HZN"},{"label":"HEMPUR","value":"HMP"},{"label":"IKKAR","value":"IKK"},{"label":"IQBALPUR","value":"IQB"},{"label":"JAHANIKHERA","value":"JKH"},{"label":"JARGAON","value":"JRJ"},{"label":"JHALRA","value":"JHH"},{"label":"JUNG BAHADURGANJ","value":"JBG"},{"label":"JWALAPUR","value":"JWP"},{"label":"KAFURPUR","value":"KFPR"},{"label":"KAHILIYA","value":"KH"},{"label":"KAILI","value":"KALI"},{"label":"KAILSA","value":"KIV"},{"label":"KAKORI","value":"KKJ"},{"label":"KANKATHER","value":"KHE"},{"label":"KANSRAO","value":"QSR"},{"label":"KANTH","value":"KNT"},{"label":"KARENGI","value":"KEG"},{"label":"KARNA","value":"KAR"},{"label":"KASTLA KASMABAD","value":"KKMB"},{"label":"KATHGHAR","value":"KGF"},{"label":"KAURHA","value":"KUF"},{"label":"KHARI JHALU","value":"KJLU"},{"label":"KHARKHAUDA","value":"KXK"},{"label":"KHURJA","value":"KRJ"},{"label":"KHURJA CITY","value":"KJY"},{"label":"KOTDWAR","value":"KTW"},{"label":"KUAKHERA","value":"KZS"},{"label":"KUCHESAR ROAD","value":"QXR"},{"label":"KUNDARKHI","value":"KD"},{"label":"LAKHNAURIA","value":"LNQ"},{"label":"LAKSAR","value":"LRJ"},{"label":"LALPUR CHANDRA","value":"LCN"},{"label":"LANDAURA","value":"LDR"},{"label":"LODHIPUR BISHANPUR","value":"LDP"},{"label":"MACHARYA","value":"MCV"},{"label":"MADHOGANJ","value":"MAH"},{"label":"MAHESHRA","value":"MHHR"},{"label":"MAHMUDPUR SARAIYAN","value":"MZN"},{"label":"MAHOLI","value":"MAHO"},{"label":"MAHRAULI","value":"MFH"},{"label":"MAINGAL GANJ","value":"MINJ"},{"label":"MAJHAULA","value":"MJHL"},{"label":"MAKHI","value":"MKHI"},{"label":"MALIHABAD","value":"MLD"},{"label":"MALLAWAN","value":"MLW"},{"label":"MAMAN","value":"MOM"},{"label":"MANDI DHANAURA","value":"MNDR"},{"label":"MASIT","value":"MST"},{"label":"MATLABPUR","value":"MTB"},{"label":"METHI TIKUR","value":"METR"},{"label":"MEWA NAWADA","value":"MWE"},{"label":"MILAK","value":"MIL"},{"label":"MIRANPUR KATRA","value":"MK"},{"label":"MISRIKH TIRATH","value":"MSTH"},{"label":"MORADABAD","value":"MB"},{"label":"MOTICHUR","value":"MOTC"},{"label":"MUAZZAMPUR NARAYAN","value":"MZM"},{"label":"MUNDHA PANDE","value":"MPH"},{"label":"MURSHADPUR","value":"MSDR"},{"label":"NAGARIA SADAT","value":"NRS"},{"label":"NAGINA","value":"NGG"},{"label":"NAIMISHARANYA","value":"NM"},{"label":"NAJIBABAD","value":"NBD"},{"label":"NERI","value":"NERI"},{"label":"NISOI","value":"NSU"},{"label":"NURNAGAR","value":"NRNR"},{"label":"PARSA KHERA","value":"PKRA"},{"label":"PATHAKPUR","value":"PHX"},{"label":"PATHRI","value":"PRI"},{"label":"PATIYARA","value":"PTYR"},{"label":"PILKHUA","value":"PKW"},{"label":"PITAMBARPUR","value":"PMR"},{"label":"PT RAM PRASAD BISMIL","value":"PRPM"},{"label":"PURAINI","value":"PNI"},{"label":"PURUA KHERA","value":"PRKE"},{"label":"RAHIMABAD","value":"RBD"},{"label":"RAISI","value":"RSI"},{"label":"RAIWALA","value":"RWL"},{"label":"RAJA KA SAHASPUR","value":"RJK"},{"label":"RAJGHAT NARORA","value":"RG"},{"label":"RAMGANGA","value":"RGB"},{"label":"RAMKOT","value":"RAK"},{"label":"RAMPUR","value":"RMU"},{"label":"RASUIYA","value":"RYS"},{"label":"REOTI BAHORA KHERA","value":"RBK"},{"label":"RISHIKESH","value":"RKSH"},{"label":"ROORKEE","value":"RK"},{"label":"ROZA","value":"ROZA"},{"label":"SAFIPUR","value":"SFPR"},{"label":"SAMBHAL HATIM SARAI","value":"SHTS"},{"label":"SANDILA","value":"SAN"},{"label":"SANEH ROAD","value":"SNX"},{"label":"SEOHARA","value":"SEO"},{"label":"SHAHJAHANPUR","value":"SPN"},{"label":"SHAHJAHANPUR KUTCHERY","value":"SXK"},{"label":"SHAHZAD NAGAR","value":"SAR"},{"label":"SHARMA","value":"SHRM"},{"label":"SHERPUR","value":"SEPR"},{"label":"SIMBHAULI","value":"SMBL"},{"label":"SIRSI MUKHDAMPUR","value":"SRMP"},{"label":"SISARKA","value":"SSKA"},{"label":"SISAUNA","value":"SISN"},{"label":"SITAPUR","value":"STP"},{"label":"SITAPUR CITY","value":"SPC"},{"label":"SONEKPUR","value":"SPB"},{"label":"SUAHERI","value":"SXQ"},{"label":"SUNAMAI HALT","value":"SUNM"},{"label":"SUNEHTI KHARKHARI","value":"SNKE"},{"label":"TILHAR","value":"TLH"},{"label":"TISUA","value":"TSA"},{"label":"TODARPUR","value":"TDP"},{"label":"UGU","value":"UGU"},{"label":"UMAR TALI","value":"UTA"},{"label":"UNCHAULIA","value":"UCH"},{"label":"URDAULI","value":"UDX"},{"label":"VIRBHADRA","value":"VRH"},{"label":"YOG NAGARI RISHIKESH","value":"YNRK"}]')},31:function(e,l,a){"use strict";a.r(l);var t=a(1),A=a(0),n=a.n(A),u=a(3),r=a.n(u),o=(a(20),a(21),a(5)),R=a(6),v=a(8),b=a(7),s=function(e){Object(v.a)(a,e);var l=Object(b.a)(a);function a(){var e;Object(o.a)(this,a);for(var t=arguments.length,A=new Array(t),u=0;u<t;u++)A[u]=arguments[u];return(e=l.call.apply(l,[this].concat(A))).state={drag:!1},e.dropRef=n.a.createRef(),e.handleDragIn=function(l){l.preventDefault(),l.stopPropagation(),e.dragCounter++,l.dataTransfer.items&&l.dataTransfer.items.length>0&&e.setState({drag:!0})},e.handleDragOut=function(l){l.preventDefault(),l.stopPropagation(),e.dragCounter--,e.dragCounter>0||e.setState({drag:!1})},e.handleDrag=function(e){e.preventDefault(),e.stopPropagation()},e.handleDrop=function(l){l.preventDefault(),l.stopPropagation(),e.setState({drag:!1}),l.dataTransfer.files&&l.dataTransfer.files.length>0&&(e.props.handleDrop(l.dataTransfer.files),l.dataTransfer.clearData(),e.dragCounter=0)},e}return Object(R.a)(a,[{key:"componentDidMount",value:function(){this.dragCounter=0;var e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop)}},{key:"componentWillUnmount",value:function(){var e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}},{key:"render",value:function(){return Object(t.jsxs)("div",{className:"drag-drop-outer-container",ref:this.dropRef,children:[this.state.drag&&Object(t.jsx)("div",{className:"drag-drop-overlay",children:Object(t.jsx)("div",{className:"drag-drop-overlay-text",children:Object(t.jsx)("div",{children:"Drop here"})})}),this.props.children]})}}]),a}(A.Component),i=a(14),H=a(33),d=a(22),N=a(25),c=a(26),I=function(e){Object(v.a)(a,e);var l=Object(b.a)(a);function a(e){var t;return Object(o.a)(this,a),(t=l.call(this,e)).state={inputFile:null,trainNumber:null,stationNames:[],stationCodes:[],stationDates:[],loading:!1,isDownloaded:!1},t.onFileUploadHandler=function(e){t.handleDrop(e.target.files)},t.handleDrop=function(e){console.log("Uploading files",e);for(var l=null,a=0;a<e.length;a++){if(!e[a].name)return;l=e[a]}console.log("Uploaded",l.name),t.setState({inputFile:l,isDownloaded:!1,trainNumber:null,stationNames:[],stationCodes:[],stationDates:[]})},t.getCellData=function(e,l){var a="";if(!e[l+1])return a;if([1,2].includes(l)){var t=new Date(e[l+1]),A=""+(t.getMonth()+1),n=""+t.getDate(),u=t.getFullYear();A.length<2&&(A="0"+A),n.length<2&&(n="0"+n),a=[u,A,n].join("-")}else a=[12,13].includes(l)?e[l+1].toString():e[l+1];return a},t.getHeading=function(e,l,a){return"LIST OF PASSENGERS DEBOARDING AT "+a+" FROM TRAIN No "+e+" DATED "+l},t.getColumnHeader=function(e){return["SL NO.","TRN SRC DATE","JRNY DATE","TRNNO","CLS","FROM STN","TO STN","BOARDING POINT","ENRT STN","PSGN NAME","AGE","GENDER","MOBNO","PNR NO","COACHNO","BERTHNO RACNO WLNO","BKG LOC ID","PNRTKTTYPE","DESTINATION ADDRESS"][e]},t.getColumnWidth=function(e){return[7,14,14,10,10,10,10,21,14,28,10,14,18,18,14,27,14,14,120][e]},t.getTextMessage=function(){for(var e={},l=0;l<t.state.stationDates.length;l++){var a=t.state.stationDates[l];a in e||(e[a]=[]),e[a].push(t.state.stationCodes[l])}var A="";for(var n in console.log(e),e)A+="LIST OF PASSENGERS DEBOARDING AT *".concat(e[n].join(" "),"* FROM TRAIN NO ").concat(t.state.trainNumber," DATED ").concat(n," \ud83d\udc47 \n");return A},t.createWorkbook=function(){var e=t.state.trainNumber+".xlsx",l=new d.Workbook,a=new d.Workbook,A=new FileReader;A.readAsArrayBuffer(t.state.inputFile),A.onload=function(){var n=A.result;l.xlsx.load(n).then((function(l){for(var A=l.worksheets[0],n=function(e){var l=t.state.stationCodes[e],n=t.state.stationNames[e],u=t.state.stationDates[e],r=a.addWorksheet(l);r.addConditionalFormatting({ref:"A1:S1000",rules:[{type:"expression",formulae:["AND(ISEVEN(ROW()),NOT(ROW()=2))"],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"ffe1f2ff"}}}}]}),r.mergeCells("A1:S1"),r.getCell("A1").value=t.getHeading(t.state.trainNumber,u,n),r.getCell("A1").alignment={horizontal:"center"},r.getCell("A1").font={name:"Cambria",size:18,bold:!0,color:{argb:"ff1f497d"}};for(var o=0;o<19;o++){var R=String.fromCharCode(65+o)+"2";r.getCell(R).value=t.getColumnHeader(o),r.getCell(R).alignment={horizontal:"center"},r.getCell(R).font={name:"Calibri",size:12,bold:!0,color:{argb:"ffffffff"}},r.getCell(R).fill={type:"pattern",pattern:"solid",fgColor:{argb:"ff0070c0"}},r.getColumn(o+1).width=t.getColumnWidth(o)}var v=1;A.eachRow({includeEmpty:!0},(function(e,a){if(a>6){var A=e.values;if(A[7]===l){for(var n=0;n<19;n++)r.getCell(String.fromCharCode(65+n)+(v+2)).value=0===n?v:t.getCellData(A,n);v+=1}}})),1===v&&(r.mergeCells("A3:S3"),r.getCell("A3").value="No matching records found",r.getCell("A3").alignment={horizontal:"center"})},u=0;u<t.state.stationCodes.length;u++)n(u);a.xlsx.writeBuffer().then((function(l){N.saveAs(new Blob([l]),e),t.setState({loading:!1,inputFile:null,isDownloaded:!0})})).catch((function(e){console.log("Error writing excel export",e),alert("Failed to create the report")}))}))}},t.stationsChangeHandler=function(e){for(var l=[],a=[],A=0;e&&A<e.length;A++)l.push(e[A].value),a.push(e[A].label);console.log(e),t.setState({stationCodes:l,stationNames:a})},t.dateChangeHandler=function(e){var l=e.target.value;if(l){for(var a=l.split(" "),A=[],n=0;n<a.length;n++){var u=a[n].trim();u&&""!==u&&A.push(u)}t.setState({stationDates:A})}},t.submitHandler=function(){t.state.trainNumber&&""!==t.state.trainNumber&&t.state.stationNames&&t.state.stationNames!==[]&&t.state.stationDates&&t.state.stationDates!==[]?t.state.stationCodes.length===t.state.stationDates.length?(t.setState({loading:!0}),t.createWorkbook()):alert("Number of dates and stations doesn't match"):alert("Enter valid details")},t.copyToClipboard=function(e){var l=document.createElement("textarea");l.innerText=e,document.body.appendChild(l),l.select(),document.execCommand("copy"),l.remove()},t.handleCopyButton=function(){var e=t.getTextMessage();t.copyToClipboard(e);var l=document.getElementById("snackbar");l.className="show",setTimeout((function(){l.className=l.className.replace("show","")}),3e3)},t.typeaheadRef=n.a.createRef(),t}return Object(R.a)(a,[{key:"render",value:function(){var e=this;return Object(t.jsx)(s,{handleDrop:this.handleDrop,children:Object(t.jsxs)("div",{className:"page-container",children:[Object(t.jsx)("div",{id:"snackbar",children:"Message copied !"}),Object(t.jsx)("img",{src:"excel.png",className:"water-mark",alt:"excel watermark"}),this.state.loading?Object(t.jsx)(H.a,{animation:"border",role:"status",style:{width:"3rem",height:"3rem"},children:Object(t.jsx)("span",{className:"sr-only",children:"Loading..."})}):null,this.state.isDownloaded?Object(t.jsx)("button",{className:"copy-btn",onClick:this.handleCopyButton,children:"Copy message"}):null,this.state.inputFile?Object(t.jsxs)("div",{className:"container",children:[Object(t.jsx)("p",{children:this.state.inputFile.name}),Object(t.jsx)("input",{className:"input-field",type:"text",placeholder:"Enter train number",onChange:function(l){e.setState({trainNumber:l.target.value})}}),Object(t.jsx)(i.a,{ref:this.typeaheadRef,options:c,isMulti:!0,className:"input-typeahead",onChange:this.stationsChangeHandler}),Object(t.jsx)("input",{className:"input-field",type:"text",placeholder:"Enter arrival dates eg. 26.10.2020, 27.10.2020",onChange:this.dateChangeHandler}),Object(t.jsx)("div",{className:"upload-btn-container",children:Object(t.jsx)("button",{className:"upload-btn",onClick:this.submitHandler,children:"Submit"})})]}):Object(t.jsxs)("div",{children:[Object(t.jsx)("label",{htmlFor:"fileUpload",className:"upload-btn",children:"Upload a file"}),Object(t.jsx)("input",{id:"fileUpload",className:"upload-input",type:"file",accept:".xlsx",onChange:this.onFileUploadHandler,multiple:!0})]})]})})}}]),a}(A.Component);var D=function(){return Object(t.jsx)(I,{})},S=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,34)).then((function(l){var a=l.getCLS,t=l.getFID,A=l.getFCP,n=l.getLCP,u=l.getTTFB;a(e),t(e),A(e),n(e),u(e)}))};r.a.render(Object(t.jsx)(n.a.StrictMode,{children:Object(t.jsx)(D,{})}),document.getElementById("root")),S()}},[[31,1,2]]]);
//# sourceMappingURL=main.7dc5fffa.chunk.js.map