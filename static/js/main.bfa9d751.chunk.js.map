{"version":3,"sources":["components/DragAndDrop.js","components/HomePage.js","App.js","reportWebVitals.js","index.js"],"names":["DragAndDrop","state","drag","dropRef","React","createRef","handleDragIn","e","preventDefault","stopPropagation","dragCounter","dataTransfer","items","length","setState","handleDragOut","handleDrag","handleDrop","files","props","clearData","this","div","current","addEventListener","removeEventListener","className","ref","children","Component","ExcelJS","require","FileSaver","HomePage","inputFile","trainNumber","stationNames","stationCodes","stationDates","loading","onFileUploadHandler","event","target","console","log","file","i","name","getCellData","data","index","txt","includes","d","Date","month","getMonth","day","getDate","year","getFullYear","join","toString","getHeading","train","date","station","getColumnHeader","getColumnWidth","createWorkbook","outputFile","inputWorkbook","Workbook","outputWorkbook","reader","FileReader","readAsArrayBuffer","onload","buffer","result","xlsx","load","then","sheet","worksheets","stationCode","stationName","stationDate","worksheet","addWorksheet","addConditionalFormatting","rules","type","formulae","style","fill","pattern","bgColor","argb","mergeCells","getCell","value","alignment","horizontal","font","size","bold","color","col","cellIndex","String","fromCharCode","fgColor","getColumn","width","SN","eachRow","includeEmpty","rowData","rowNumber","row","values","writeBuffer","saveAs","Blob","catch","err","alert","stationsChangeHandler","push","label","dateChangeHandler","dates","dateArray","split","trim","submitHandler","typeaheadRef","src","alt","Spinner","animation","role","height","placeholder","onChange","options","isMulti","onClick","htmlFor","id","multiple","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.bfa9d751.chunk.js","sourcesContent":["import React, {Component} from 'react';\n\nclass DragAndDrop extends Component {\n\n    state = {\n        drag: false\n    }\n\n      \n    dropRef = React.createRef()\n\n    handleDragIn = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.dragCounter++;\n        if (e.dataTransfer.items && e.dataTransfer.items.length>0) {\n            this.setState({\n                drag:true\n            })\n        }\n    }\n\n    handleDragOut = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.dragCounter--;\n        if (this.dragCounter>0) \n            return\n        this.setState({\n            drag:false\n        })\n    }\n\n    handleDrag = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    handleDrop = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.setState({\n            drag:false\n        });\n        if (e.dataTransfer.files && e.dataTransfer.files.length>0) {\n            this.props.handleDrop(e.dataTransfer.files);\n            e.dataTransfer.clearData();\n            this.dragCounter=0;\n        }\n    }\n\n    componentDidMount() {\n        this.dragCounter=0;\n        let div = this.dropRef.current;\n        div.addEventListener('dragenter',this.handleDragIn);\n        div.addEventListener('dragleave',this.handleDragOut);\n        div.addEventListener('dragover',this.handleDrag);\n        div.addEventListener('drop',this.handleDrop);\n    }\n\n    componentWillUnmount() {\n        let div = this.dropRef.current;\n        div.removeEventListener('dragenter',this.handleDragIn);\n        div.removeEventListener('dragleave',this.handleDragOut);\n        div.removeEventListener('dragover',this.handleDrag);\n        div.removeEventListener('drop',this.handleDrop);\n    }\n\n    render() {\n        return (\n            <div className='drag-drop-outer-container' ref={this.dropRef}>\n                {this.state.drag &&\n                    <div className='drag-drop-overlay'>\n                        <div className='drag-drop-overlay-text'>\n                            <div>Drop here</div>\n                        </div>\n                    </div>\n                }\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nexport default DragAndDrop;","import React, {Component} from 'react';\nimport DragAndDrop from './DragAndDrop';\nimport Select from 'react-select'\nimport { Spinner } from 'reactstrap';\n\nconst ExcelJS = require('exceljs');\nvar FileSaver = require('file-saver');\n\nclass HomePage extends Component {\n\n    state = {\n        inputFile: null,\n\n        trainNumber: null,\n        stationNames: [],\n        stationCodes: [],\n        stationDates: [],\n\n        loading: false\n    }\n\n    constructor(props) {\n        super(props);\n        this.typeaheadRef = React.createRef();\n    }\n\n    onFileUploadHandler = (event)=> {\n        this.handleDrop(event.target.files);\n    }\n\n    handleDrop = (files) => {\n        console.log(\"Uploading files\",files);\n        let file = null;\n        for (let i=0;i<files.length;i++) {\n            if (!files[i].name)\n                return;\n            file = files[i];\n        }\n        console.log(\"Uploaded\",file.name);\n        this.setState({\n            inputFile: file\n        });\n    }\n\n    getCellData = (data, index) => {\n        const time_cell = [1, 2];\n        const number_cell = [12, 13];\n        let txt = '';\n\n        if (!data[index+1])\n            return txt\n        \n        if (time_cell.includes(index)) {\n            let d = new Date(data[index+1]);\n            let month = '' + (d.getMonth() + 1);\n            let day = '' + d.getDate();\n            let year = d.getFullYear();\n\n            if (month.length < 2) \n                month = '0' + month;\n            if (day.length < 2) \n                day = '0' + day;\n\n            txt = [year, month, day].join('-');\n        } else if (number_cell.includes(index)) {\n            txt = data[index+1].toString();\n        }else {\n            txt = data[index+1];\n        }\n        \n        return txt;\n    }\n    \n    getHeading = (train, date, station) => {\n        return 'LIST OF PASSENGERS DEBOARDING AT ' + station + ' FROM TRAIN No ' + train + ' DATED ' + date;\n    }\n\n    getColumnHeader = (index) => {\n        const header = ['SL NO.', 'TRN SRC DATE', 'JRNY DATE', 'TRNNO', 'CLS',\n                  'FROM STN', 'TO STN', 'BOARDING POINT', 'ENRT STN', \n                  'PSGN NAME', 'AGE', 'GENDER', 'MOBNO', 'PNR NO', 'COACHNO',\n                  'BERTHNO RACNO WLNO', 'BKG LOC ID', 'PNRTKTTYPE', 'DESTINATION ADDRESS'];\n        return header[index];\n    }\n\n    getColumnWidth = (index) => {\n        const width = [14, 14, 14, 14, 14, 14, 14, 21, 14, 14, 14, 14, 14, 14,\n                 14, 27, 14, 14, 28]\n        return width[index]\n    }\n\n    createWorkbook = () => {\n        const emptyMessage = 'No matching records found';\n        const outputFile = this.state.trainNumber+'.xlsx';\n        \n        const inputWorkbook = new ExcelJS.Workbook();\n        const outputWorkbook = new ExcelJS.Workbook();\n        const reader = new FileReader();\n\n        // Reading input file\n        reader.readAsArrayBuffer(this.state.inputFile);\n        reader.onload = () => {\n            const buffer = reader.result;\n            inputWorkbook.xlsx.load(buffer).then(inputWorkbook => {\n                const sheet = inputWorkbook.worksheets[0];\n\n                for (let i = 0; i < this.state.stationCodes.length; i++) {\n                    const stationCode = this.state.stationCodes[i];\n                    const stationName = this.state.stationNames[i];\n                    const stationDate = this.state.stationDates[i];\n\n                    // Adding sheet\n                    const worksheet = outputWorkbook.addWorksheet(stationCode);\n\n                    // Adding conditional formatting\n                    worksheet.addConditionalFormatting({\n                        ref: 'A1:S1000',\n                        rules: [{\n                            type: 'expression',\n                            formulae: ['AND(ISEVEN(ROW()),NOT(ROW()=2))'],\n                            style: {\n                                fill: {\n                                    type: 'pattern',\n                                    pattern: 'solid',\n                                    bgColor: {argb: 'ffe1f2ff'}\n                                }\n                            }\n                        }]\n                    });\n\n                    // Adding heading\n                    worksheet.mergeCells('A1:S1');\n                    worksheet.getCell('A1').value = this.getHeading(this.state.trainNumber, stationDate, stationName);\n                    worksheet.getCell('A1').alignment = { horizontal: 'center'};\n                    worksheet.getCell('A1').font = { name:'Cambria', size: 18, bold: true, color: {argb: 'ff1f497d'}};\n\n                    // Adding column headers\n                    for (let col=0; col<19; col++) {\n                        let cellIndex = String.fromCharCode(65+col)+'2';\n                        worksheet.getCell(cellIndex).value = this.getColumnHeader(col);\n                        worksheet.getCell(cellIndex).alignment = { horizontal: 'center'};\n                        worksheet.getCell(cellIndex).font = { name:'Calibri', size: 12, bold: true, color: {argb: 'ffffffff'}};\n                        worksheet.getCell(cellIndex).fill = { type: 'pattern', pattern: 'solid', fgColor: {argb: 'ff0070c0'}};\n                        worksheet.getColumn(col+1).width = this.getColumnWidth(col);\n                    }\n\n                    // Copying data\n                    let SN = 1;\n                    sheet.eachRow({ includeEmpty: true }, (rowData, rowNumber) => {\n                        if (rowNumber > 6) {\n                            let row = rowData.values;\n                            if (row[7] === stationCode) {\n                                for (let col=0; col<19; col++) {\n                                    if (col===0) {\n                                        worksheet.getCell(String.fromCharCode(65+col)+(SN+2)).value = SN;\n                                    } else {\n                                        worksheet.getCell(String.fromCharCode(65+col)+(SN+2)).value = this.getCellData(row, col);\n                                    }\n                                }\n                                SN+=1;\n                            }\n                        }\n                    });\n\n                    // No data found\n                    if (SN===1) {\n                        worksheet.mergeCells('A3:S3');\n                        worksheet.getCell('A3').value = emptyMessage;\n                        worksheet.getCell('A3').alignment = { horizontal:'center'};\n                    }\n                }\n\n                // Saving file\n                outputWorkbook.xlsx.writeBuffer()\n                    .then(buffer => {\n                        FileSaver.saveAs(new Blob([buffer]), outputFile);\n                        this.setState({loading: false});\n                    })\n                    .catch(err => {\n                        console.log('Error writing excel export', err);\n                        alert('Failed to create the report');\n                    });\n                \n            });\n        }\n\n    }\n\n    stationsChangeHandler = (values) => {\n        let stationCodes = [];\n        let stationNames = [];\n\n        for (let i=0;values && i<values.length;i++) {\n            stationCodes.push(values[i].value);\n            stationNames.push(values[i].label);\n        }\n\n        console.log(values);\n\n        this.setState({stationCodes, stationNames});\n    }\n\n    dateChangeHandler = (event) => {\n        let dates = event.target.value;\n        if (!dates)\n            return;\n        \n        let dateArray = dates.split(' ');\n        let stationDates = [];\n        for (let i=0;i<dateArray.length;i++) {\n            let stationDate = dateArray[i].trim();\n            if (stationDate && stationDate !== '')\n                stationDates.push(stationDate);\n        }\n\n        this.setState({stationDates});\n    }\n\n    submitHandler = () => {\n\n        if (!this.state.trainNumber || this.state.trainNumber === '' ||\n            !this.state.stationNames || this.state.stationNames === [] ||\n            !this.state.stationDates || this.state.stationDates === []) {\n            alert('Enter valid details');\n            return;\n        } else if (this.state.stationCodes.length !== this.state.stationDates.length) {\n            alert(\"Number of dates and stations doesn't match\");\n            return;\n        }\n\n        this.setState({loading: true});\n        this.createWorkbook();\n    }\n\n    render() {\n\n        const options = [\n            { label: 'BALAMAU', value: 'BLM' },\n            { label: 'HARDOI', value: 'HRI' },\n            { label: 'ANJHI SHAHABAD', value: 'AJI' },\n            { label: 'SHAHJAHANPUR', value: 'SPN' },\n            { label: 'TILHAR', value: 'TLH' },\n            { label: 'PITAMBARPUR', value: 'PMR' },\n            { label: 'BAREILLY', value: 'BE' },\n            { label: 'MILAK', value: 'MIL' },\n            { label: 'RAMPUR', value: 'RMU' },\n            { label: 'MORADABAD', value: 'MB' },\n            { label: 'KANTH', value: 'KNT' },\n            { label: 'SEOHARA', value: 'SEO' },\n            { label: 'DHAMPUR', value: 'DPR' },\n            { label: 'NAGINA', value: 'NGG' },\n            { label: 'NAJIBABAD', value: 'NBD' },\n            { label: 'LAKSAR', value: 'LRJ' },\n            { label: 'ROORKEE', value: 'RK' },\n            { label: 'HARIDWAR', value: 'HW' },\n            { label: 'DEHRADUN', value: 'DDN' },\n            { label: 'DOIWALA', value: 'DWO' },\n            { label: 'GARHMUKTESAR', value: 'GMS' },\n            { label: 'HARRAWALA', value: 'HRW' },\n            { label: 'KANSRAO', value: 'QSR' },\n            { label: 'KOTDWAR', value: 'KTW' },\n            { label: 'RAIWALA', value: 'RWL' },\n            { label: 'CHANDAUSI', value: 'CH' },\n            { label: 'ROZA', value: 'ROZA' },\n            { label: 'GAJRAULA', value: 'GJL' },\n            { label: 'BIJNOR', value: 'BJO' },\n            { label: 'BULANDSHAHR', value: 'BSC' },\n            { label: 'CHANDPUR SIAU', value: 'CPS' },\n            { label: 'RAJA KA SAHASPUR', value: 'RJK' },\n            { label: 'RAJGHAT NARORA', value: 'RG' },\n            { label: 'RISHIKESH', value: 'RKSH' },\n            { label: 'SANDILA', value: 'SAN' },\n            { label: 'PILKHUWA', value: 'PKW' },\n            { label: 'HAPUR', value: 'HPU' },\n            { label: 'AMROHA', value: 'AMRO' }\n        ];\n\n        return (\n            <DragAndDrop handleDrop={this.handleDrop}>\n                <div className='page-container'>\n                    <img src='excel.png' className='water-mark' alt='excel watermark'/>\n                    {this.state.loading ? (\n                        <Spinner animation=\"border\" role=\"status\" style={{ width: '3rem', height: '3rem' }}>\n                            <span className=\"sr-only\">Loading...</span>\n                        </Spinner>\n                    ) : null}\n\n                    {this.state.inputFile ? (\n                        <div className='container'>\n                            <p>{this.state.inputFile.name}</p>\n                            <input className='input-field' type='text' placeholder='Enter train number' onChange={(event) => {this.setState({trainNumber: event.target.value})}}/>\n                            <Select ref={this.typeaheadRef} options={options} isMulti className='input-typeahead' onChange={this.stationsChangeHandler}/>\n                            <input className='input-field' type='text' placeholder='Enter arrival dates eg. 26.10.2020, 27.10.2020' onChange={this.dateChangeHandler}/>\n                            <div className='upload-btn-container'>\n                                <button className='upload-btn' onClick={this.submitHandler}>Submit</button>\n                            </div>\n                        </div>\n                    ) : (\n                        <div>\n                            <label htmlFor='fileUpload' className='upload-btn'>Upload a file</label>\n                            <input id='fileUpload' className='upload-input' type='file' onChange={this.onFileUploadHandler} multiple/>\n                        </div>\n                    )}\n                </div>\n            </DragAndDrop>\n            \n        );\n    }\n}\n\nexport default HomePage","import './App.css';\nimport HomePage from './components/HomePage';\n\n\nfunction App() {\n\treturn  (\n\t\t<HomePage />\n\t);\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\n// import 'react-bootstrap-typeahead/css/Typeahead.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}