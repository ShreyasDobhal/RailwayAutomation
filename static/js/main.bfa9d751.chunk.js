(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{20:function(e,t,a){},21:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var l=a(1),n=a(0),r=a.n(n),o=a(3),i=a.n(o),s=(a(20),a(21),a(5)),u=a(6),d=a(8),c=a(7),g=function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(s.a)(this,a);for(var l=arguments.length,n=new Array(l),o=0;o<l;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={drag:!1},e.dropRef=r.a.createRef(),e.handleDragIn=function(t){t.preventDefault(),t.stopPropagation(),e.dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0&&e.setState({drag:!0})},e.handleDragOut=function(t){t.preventDefault(),t.stopPropagation(),e.dragCounter--,e.dragCounter>0||e.setState({drag:!1})},e.handleDrag=function(e){e.preventDefault(),e.stopPropagation()},e.handleDrop=function(t){t.preventDefault(),t.stopPropagation(),e.setState({drag:!1}),t.dataTransfer.files&&t.dataTransfer.files.length>0&&(e.props.handleDrop(t.dataTransfer.files),t.dataTransfer.clearData(),e.dragCounter=0)},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.dragCounter=0;var e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop)}},{key:"componentWillUnmount",value:function(){var e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}},{key:"render",value:function(){return Object(l.jsxs)("div",{className:"drag-drop-outer-container",ref:this.dropRef,children:[this.state.drag&&Object(l.jsx)("div",{className:"drag-drop-overlay",children:Object(l.jsx)("div",{className:"drag-drop-overlay-text",children:Object(l.jsx)("div",{children:"Drop here"})})}),this.props.children]})}}]),a}(n.Component),h=a(14),f=a(32),v=a(22),A=a(25),b=function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(e){var l;return Object(s.a)(this,a),(l=t.call(this,e)).state={inputFile:null,trainNumber:null,stationNames:[],stationCodes:[],stationDates:[],loading:!1},l.onFileUploadHandler=function(e){l.handleDrop(e.target.files)},l.handleDrop=function(e){console.log("Uploading files",e);for(var t=null,a=0;a<e.length;a++){if(!e[a].name)return;t=e[a]}console.log("Uploaded",t.name),l.setState({inputFile:t})},l.getCellData=function(e,t){var a="";if(!e[t+1])return a;if([1,2].includes(t)){var l=new Date(e[t+1]),n=""+(l.getMonth()+1),r=""+l.getDate(),o=l.getFullYear();n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),a=[o,n,r].join("-")}else a=[12,13].includes(t)?e[t+1].toString():e[t+1];return a},l.getHeading=function(e,t,a){return"LIST OF PASSENGERS DEBOARDING AT "+a+" FROM TRAIN No "+e+" DATED "+t},l.getColumnHeader=function(e){return["SL NO.","TRN SRC DATE","JRNY DATE","TRNNO","CLS","FROM STN","TO STN","BOARDING POINT","ENRT STN","PSGN NAME","AGE","GENDER","MOBNO","PNR NO","COACHNO","BERTHNO RACNO WLNO","BKG LOC ID","PNRTKTTYPE","DESTINATION ADDRESS"][e]},l.getColumnWidth=function(e){return[14,14,14,14,14,14,14,21,14,14,14,14,14,14,14,27,14,14,28][e]},l.createWorkbook=function(){var e=l.state.trainNumber+".xlsx",t=new v.Workbook,a=new v.Workbook,n=new FileReader;n.readAsArrayBuffer(l.state.inputFile),n.onload=function(){var r=n.result;t.xlsx.load(r).then((function(t){for(var n=t.worksheets[0],r=function(e){var t=l.state.stationCodes[e],r=l.state.stationNames[e],o=l.state.stationDates[e],i=a.addWorksheet(t);i.addConditionalFormatting({ref:"A1:S1000",rules:[{type:"expression",formulae:["AND(ISEVEN(ROW()),NOT(ROW()=2))"],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"ffe1f2ff"}}}}]}),i.mergeCells("A1:S1"),i.getCell("A1").value=l.getHeading(l.state.trainNumber,o,r),i.getCell("A1").alignment={horizontal:"center"},i.getCell("A1").font={name:"Cambria",size:18,bold:!0,color:{argb:"ff1f497d"}};for(var s=0;s<19;s++){var u=String.fromCharCode(65+s)+"2";i.getCell(u).value=l.getColumnHeader(s),i.getCell(u).alignment={horizontal:"center"},i.getCell(u).font={name:"Calibri",size:12,bold:!0,color:{argb:"ffffffff"}},i.getCell(u).fill={type:"pattern",pattern:"solid",fgColor:{argb:"ff0070c0"}},i.getColumn(s+1).width=l.getColumnWidth(s)}var d=1;n.eachRow({includeEmpty:!0},(function(e,a){if(a>6){var n=e.values;if(n[7]===t){for(var r=0;r<19;r++)i.getCell(String.fromCharCode(65+r)+(d+2)).value=0===r?d:l.getCellData(n,r);d+=1}}})),1===d&&(i.mergeCells("A3:S3"),i.getCell("A3").value="No matching records found",i.getCell("A3").alignment={horizontal:"center"})},o=0;o<l.state.stationCodes.length;o++)r(o);a.xlsx.writeBuffer().then((function(t){A.saveAs(new Blob([t]),e),l.setState({loading:!1})})).catch((function(e){console.log("Error writing excel export",e),alert("Failed to create the report")}))}))}},l.stationsChangeHandler=function(e){for(var t=[],a=[],n=0;e&&n<e.length;n++)t.push(e[n].value),a.push(e[n].label);console.log(e),l.setState({stationCodes:t,stationNames:a})},l.dateChangeHandler=function(e){var t=e.target.value;if(t){for(var a=t.split(" "),n=[],r=0;r<a.length;r++){var o=a[r].trim();o&&""!==o&&n.push(o)}l.setState({stationDates:n})}},l.submitHandler=function(){l.state.trainNumber&&""!==l.state.trainNumber&&l.state.stationNames&&l.state.stationNames!==[]&&l.state.stationDates&&l.state.stationDates!==[]?l.state.stationCodes.length===l.state.stationDates.length?(l.setState({loading:!0}),l.createWorkbook()):alert("Number of dates and stations doesn't match"):alert("Enter valid details")},l.typeaheadRef=r.a.createRef(),l}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return Object(l.jsx)(g,{handleDrop:this.handleDrop,children:Object(l.jsxs)("div",{className:"page-container",children:[Object(l.jsx)("img",{src:"excel.png",className:"water-mark",alt:"excel watermark"}),this.state.loading?Object(l.jsx)(f.a,{animation:"border",role:"status",style:{width:"3rem",height:"3rem"},children:Object(l.jsx)("span",{className:"sr-only",children:"Loading..."})}):null,this.state.inputFile?Object(l.jsxs)("div",{className:"container",children:[Object(l.jsx)("p",{children:this.state.inputFile.name}),Object(l.jsx)("input",{className:"input-field",type:"text",placeholder:"Enter train number",onChange:function(t){e.setState({trainNumber:t.target.value})}}),Object(l.jsx)(h.a,{ref:this.typeaheadRef,options:[{label:"BALAMAU",value:"BLM"},{label:"HARDOI",value:"HRI"},{label:"ANJHI SHAHABAD",value:"AJI"},{label:"SHAHJAHANPUR",value:"SPN"},{label:"TILHAR",value:"TLH"},{label:"PITAMBARPUR",value:"PMR"},{label:"BAREILLY",value:"BE"},{label:"MILAK",value:"MIL"},{label:"RAMPUR",value:"RMU"},{label:"MORADABAD",value:"MB"},{label:"KANTH",value:"KNT"},{label:"SEOHARA",value:"SEO"},{label:"DHAMPUR",value:"DPR"},{label:"NAGINA",value:"NGG"},{label:"NAJIBABAD",value:"NBD"},{label:"LAKSAR",value:"LRJ"},{label:"ROORKEE",value:"RK"},{label:"HARIDWAR",value:"HW"},{label:"DEHRADUN",value:"DDN"},{label:"DOIWALA",value:"DWO"},{label:"GARHMUKTESAR",value:"GMS"},{label:"HARRAWALA",value:"HRW"},{label:"KANSRAO",value:"QSR"},{label:"KOTDWAR",value:"KTW"},{label:"RAIWALA",value:"RWL"},{label:"CHANDAUSI",value:"CH"},{label:"ROZA",value:"ROZA"},{label:"GAJRAULA",value:"GJL"},{label:"BIJNOR",value:"BJO"},{label:"BULANDSHAHR",value:"BSC"},{label:"CHANDPUR SIAU",value:"CPS"},{label:"RAJA KA SAHASPUR",value:"RJK"},{label:"RAJGHAT NARORA",value:"RG"},{label:"RISHIKESH",value:"RKSH"},{label:"SANDILA",value:"SAN"},{label:"PILKHUWA",value:"PKW"},{label:"HAPUR",value:"HPU"},{label:"AMROHA",value:"AMRO"}],isMulti:!0,className:"input-typeahead",onChange:this.stationsChangeHandler}),Object(l.jsx)("input",{className:"input-field",type:"text",placeholder:"Enter arrival dates eg. 26.10.2020, 27.10.2020",onChange:this.dateChangeHandler}),Object(l.jsx)("div",{className:"upload-btn-container",children:Object(l.jsx)("button",{className:"upload-btn",onClick:this.submitHandler,children:"Submit"})})]}):Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{htmlFor:"fileUpload",className:"upload-btn",children:"Upload a file"}),Object(l.jsx)("input",{id:"fileUpload",className:"upload-input",type:"file",onChange:this.onFileUploadHandler,multiple:!0})]})]})})}}]),a}(n.Component);var p=function(){return Object(l.jsx)(b,{})},R=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,33)).then((function(t){var a=t.getCLS,l=t.getFID,n=t.getFCP,r=t.getLCP,o=t.getTTFB;a(e),l(e),n(e),r(e),o(e)}))};i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(p,{})}),document.getElementById("root")),R()}},[[30,1,2]]]);
//# sourceMappingURL=main.bfa9d751.chunk.js.map